{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/utils/emitter.ts","webpack:///./src/utils/string.ts","webpack:///./src/utils/html.ts","webpack:///./src/core/viewmatrix.ts","webpack:///./src/utils/objects.ts","webpack:///./src/utils/math.ts","webpack:///./src/index.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","Emitter","this","callbacks","on","event","callback","key","push","once","off","apply","arguments","length","index","indexOf","splice","emit","args","_i","_a","callbacks_1","slice","listeners","hasListeners","sanitize","str","trim","replace","addClassToElement","el","Element","classes","split","result","className","classes_1","removeClassFromElement","Array","classes_2","removeAttribute","setElementStyle","style","getAttribute","RegExp","setAttribute","toggleClassInElement","condition","_super","ViewMatrix","parentSelector","options","_this","children","defaults","startingIndex","childrenSelector","classAliases","element","infinite","child","current","behind","ahead","beyond","classPrefix","adjacentCount","handleZIndex","wrap","currentIndex","target","sources","TypeError","to","nextSource","nextKey","merge","refresh","__extends","destroy","document","querySelector","Error","selector","querySelectorAll","wrapIndex","prepareClassNames","slide","childrenCount","Math","max","distanceCount","floor","indexCount","distance","isAhead","isBehind","isBeyond","abs","inc","increment","prefix","aliases","k","min","clamp","emitter","window","viewmatrix"],"mappings":"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","file":"./viewmatrix.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","// based off of component-emitter package\r\n// https://github.com/component/emitter\r\n\r\ntype EmitterCallback = (...args: any[]) => void;\r\n\r\nexport default abstract class Emitter {\r\n\r\n\t/**\r\n\t * List of callbacks maintained by the class.\r\n\t */\r\n\tprivate callbacks: { [id: string]: EmitterCallback[] } = {};\r\n\r\n\t/**\r\n\t * Listens on the given `event` with `callback`.\r\n\t * @param event The event to add the listener to.\r\n\t * @param callback Listener to invoke.\r\n\t */\r\n\tpublic on(event: string, callback: EmitterCallback): Emitter {\r\n\t\tconst key = '$' + event;\r\n\t\t(this.callbacks[key] = this.callbacks[key] || []).push(callback);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t/**\r\n\t * Adds an `event` listener that will be invoked a single time then automatically removed.\r\n\t * @param event The event to add the listener to.\r\n\t * @param callback Listener to invoke.\r\n\t */\r\n\tpublic once(event: string, callback: EmitterCallback): Emitter {\r\n\t\tfunction on() {\r\n\t\t\tthis.off(event, on);\r\n\t\t\tcallback.apply(this, arguments);\r\n\t\t}\r\n\t\t(on as any).callback = callback;\r\n\t\tthis.on(event, on);\r\n\t\treturn this;\r\n\t}\r\n\r\n\t/**\r\n\t * Removes the given callback for `event` or all registered callbacks.\r\n\t * @param event The event to remove the listener(s) from.\r\n\t * @param callback Specific listener to remove.\r\n\t */\r\n\tpublic off(event?: string, callback?: EmitterCallback): Emitter {\r\n\t\t// remove all events\r\n\t\tif (arguments.length === 0) {\r\n\t\t\tthis.callbacks = {};\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t// remove specific event\r\n\t\tconst key = '$' + event;\r\n\t\tconst callbacks = this.callbacks[key];\r\n\t\tif (!callbacks) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t// remove all handlers\r\n\t\tif (arguments.length === 1) {\r\n\t\t\tdelete this.callbacks[key];\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t// remove specific handler\r\n\t\tconst index = callbacks.indexOf(callback);\r\n\t\tif (index !== -1 && callbacks[index] === callback) {\r\n\t\t\tcallbacks.splice(index, 1);\r\n\t\t}\r\n\r\n\t\t// remove event-specific arrays without callbacks\r\n\t\t// to avoid memory leaks\r\n\t\tif (callbacks.length === 0) {\r\n\t\t\tdelete this.callbacks[key];\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\t/**\r\n\t * Emits `event` with the given `args`.\r\n\t * @param event The event to trigger.\r\n\t * @param args Arguments to pass to each callback.\r\n\t */\r\n\tpublic emit(event: string, ...args: any[]): Emitter {\r\n\t\tlet callbacks = this.callbacks['$' + event];\r\n\t\tif (callbacks && callbacks.length > 0) {\r\n\t\t\tcallbacks = callbacks.slice(0);\r\n\t\t\tfor (const c of callbacks) {\r\n\t\t\t\tc.apply(this, args);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns an array of callbacks for `event`.\r\n\t * @param event The event to get the listeners from.\r\n\t */\r\n\tpublic listeners(event: string): EmitterCallback[] {\r\n\t\treturn this.callbacks['$' + event] || [];\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if this emitter has `event` handlers.\r\n\t * @param event The event to verify.\r\n\t */\r\n\tpublic hasListeners(event: string): boolean {\r\n\t\treturn !!this.listeners(event).length;\r\n\t}\r\n\r\n}\r\n","/**\r\n * Clears all extra spaces in a string.\r\n * @param str String to sanitize.\r\n */\r\nexport function sanitize(str: string): string {\r\n\treturn ('' + str).trim().replace(/\\s\\s+/g, ' ');\r\n}\r\n","import { sanitize } from './string';\r\n\r\n/**\r\n * Adds a class to a given HTML element.\r\n * @param el The element to add the class to.\r\n * @param str The class to add.\r\n */\r\nexport function addClassToElement(el: any, str: any): void {\r\n\tif (!(el instanceof Element)) { return; }\r\n\tconst classes = sanitize(str).split(' ');\r\n\tlet result = el.className.trim();\r\n\tfor (const c of classes) {\r\n\t\tif (result.indexOf(c) === -1) {\r\n\t\t\tresult = result + ' ' + c;\r\n\t\t}\r\n\t}\r\n\tel.className = sanitize(result);\r\n}\r\n\r\n/**\r\n * Returns children inside an element.\r\n * @param el The element to return children from.\r\n * @param selector Query selector to filter children.\r\n */\r\nexport function findChildrenInElement(el: Element, selector?: string): Element[] {\r\n\treturn typeof selector === 'string'\r\n\t\t? [].slice.call(el.querySelectorAll(':scope > ' + selector))\r\n\t\t: el.children;\r\n}\r\n\r\n/**\r\n * Removes a class from a given HTML element.\r\n * @param el The element to remove the class from.\r\n * @param str The class to remove.\r\n */\r\nexport function removeClassFromElement(el: Element, str: string | string[]): void {\r\n\tif (!(el instanceof Element)) { return; }\r\n\tconst classes = !(str instanceof Array)\r\n\t\t? sanitize(str).split(' ')\r\n\t\t: str;\r\n\tlet result = el.className.trim();\r\n\tfor (const c of classes) {\r\n\t\tif (result.indexOf(c) !== -1) {\r\n\t\t\tresult = result.replace(c, '');\r\n\t\t}\r\n\t}\r\n\tel.className = sanitize(result);\r\n\tif (el.className.length === 0) {\r\n\t\tel.removeAttribute('class');\r\n\t}\r\n}\r\n\r\n/**\r\n * Sets the inline style of an element.\r\n * If \"null\" is provided as the value, the style will be erased.\r\n * @param el The element to style.\r\n * @param name The name of the style to add.\r\n * @param value The value for the style. A value of \"null\" will erase the style.\r\n */\r\nexport function setElementStyle(el: Element, name: string, value: any): string {\r\n\tlet style = sanitize(el.getAttribute('style') || '');\r\n\tif (value == null || style.indexOf(name + ':') !== -1) {\r\n\t\tstyle = style.replace(new RegExp(name + ':[^;]+;', 'g'), '');\r\n\t}\r\n\tif (value != null) {\r\n\t\tstyle += name + ':' + value + ';';\r\n\t}\r\n\tif (style.length > 0) {\r\n\t\tel.setAttribute('style', sanitize(style));\r\n\t}\r\n\telse {\r\n\t\tel.removeAttribute('style');\r\n\t}\r\n\treturn style;\r\n}\r\n\r\n/**\r\n * Toggles a class in a given HTML element.\r\n * The class will be added if the condition is true.\r\n * It will be removed otherwise.\r\n * @param el The element to toggle the class in.\r\n * @param str The class to toggle.\r\n * @param condition Condition to determine if class is added or removed.\r\n */\r\nexport function toggleClassInElement(el: Element, str: string, condition: boolean): boolean {\r\n\tif (condition) {\r\n\t\taddClassToElement(el, str);\r\n\t}\r\n\telse {\r\n\t\tremoveClassFromElement(el, str);\r\n\t}\r\n\treturn condition;\r\n}\r\n","import Emitter from '../utils/emitter';\r\nimport { addClassToElement, findChildrenInElement, removeClassFromElement, setElementStyle, toggleClassInElement } from '../utils/html';\r\nimport { clamp, wrap } from '../utils/math';\r\nimport { merge } from '../utils/objects';\r\nimport IViewMatrixClassAliases from './iviewmatrixclassaliases';\r\nimport IViewMatrixOptions from './iviewmatrixoptions';\r\n\r\nexport default class ViewMatrix extends Emitter {\r\n\r\n\t/**\r\n\t * The instance's target element.\r\n\t */\r\n\tpublic element: Element;\r\n\r\n\t/**\r\n\t * The instance's options.\r\n\t */\r\n\tpublic readonly options: IViewMatrixOptions;\r\n\r\n\t/**\r\n\t * The ViewMatrix instance's children.\r\n\t */\r\n\tprivate children: Element[] = null;\r\n\r\n\t/**\r\n\t * The class' instance defaults.\r\n\t */\r\n\tprivate defaults: IViewMatrixOptions = {\r\n\t\t// state init\r\n\t\tstartingIndex: 0,\r\n\t\t// selectors\r\n\t\tchildrenSelector: '*',\r\n\t\t// classes\r\n\t\tclassAliases: {\r\n\t\t\telement: 'element',\r\n\t\t\tinfinite: 'infinite',\r\n\t\t\tchild: 'child',\r\n\t\t\tcurrent: 'current',\r\n\t\t\tbehind: 'behind',\r\n\t\t\tahead: 'ahead',\r\n\t\t\tbeyond: 'beyond'\r\n\t\t},\r\n\t\tclassPrefix: 'vm-',\r\n\t\t// function\r\n\t\tadjacentCount: 1,\r\n\t\thandleZIndex: true,\r\n\t\tinfinite: false,\r\n\t\twrap: true\r\n\t};\r\n\r\n\t/**\r\n\t * List of class names frequently used for children elements.\r\n\t */\r\n\tprivate classAliases: { [id: string]: string } = {};\r\n\r\n\t/**\r\n\t * Current slide's index.\r\n\t */\r\n\tprivate currentIndex: number = 0;\r\n\r\n\t/**\r\n\t * Creates a new ViewMatrix instance.\r\n\t * @param selector The target selector or element for the instance.\r\n\t * @param options Options for the instance.\r\n\t */\r\n\tconstructor(parentSelector: string | Element, options?: IViewMatrixOptions) {\r\n\t\tsuper();\r\n\t\tthis.options = merge(({} as IViewMatrixOptions), this.defaults, options);\r\n\t\tthis.refresh(parentSelector, this.options.childrenSelector);\r\n\t}\r\n\r\n\t/**\r\n\t * Destroys the ViewMatrix instance.\r\n\t */\r\n\tpublic destroy(): void {\r\n\t\t// reset current element\r\n\t\tif (this.element) {\r\n\t\t\tremoveClassFromElement(this.element, [\r\n\t\t\t\tthis.classAliases.element,\r\n\t\t\t\tthis.classAliases.infinite\r\n\t\t\t]);\r\n\t\t}\r\n\r\n\t\t// reset current children\r\n\t\tif (this.children && this.children.length > 0) {\r\n\t\t\tfor (const child of this.children) {\r\n\t\t\t\tremoveClassFromElement(child, [\r\n\t\t\t\t\tthis.classAliases.child,\r\n\t\t\t\t\tthis.classAliases.current,\r\n\t\t\t\t\tthis.classAliases.beyond,\r\n\t\t\t\t\tthis.classAliases.behind,\r\n\t\t\t\t\tthis.classAliases.ahead\r\n\t\t\t\t] );\r\n\t\t\t\tsetElementStyle(child, 'z-index', null);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// trigger event\r\n\t\tthis.emit('destroy', this.element, this.children);\r\n\r\n\t\t// reset vars\r\n\t\tthis.element = null;\r\n\t\tthis.children = null;\r\n\t}\r\n\r\n\t/**\r\n\t * Refreshes the instance.\r\n\t * @param parentSelector The query selector to find the element.\r\n\t * @param childrenSelector An optional query selector to filter children.\r\n\t */\r\n\tpublic refresh(parentSelector: string | Element, childrenSelector?: string) {\r\n\t\t// destroy first\r\n\t\tthis.destroy();\r\n\r\n\t\t// get a valid selector\r\n\t\tparentSelector = parentSelector != null ? parentSelector : null;\r\n\r\n\t\t// check if we have an object,\r\n\t\t// if we do, POPULATE ALL THE VARS\r\n\t\tif (typeof parentSelector === 'string') {\r\n\t\t\tthis.element = document.querySelector(parentSelector) || null;\r\n\t\t}\r\n\t\telse if (parentSelector instanceof Element) {\r\n\t\t\tthis.element = parentSelector;\r\n\t\t}\r\n\r\n\t\t// do we still have a target?\r\n\t\t// if not, throw a hissy fit\r\n\t\tif (!this.element) {\r\n\t\t\tthrow new Error('No valid selector provided to ViewMatrix instance');\r\n\t\t}\r\n\r\n\t\t// (also update the selectors in the options to these)\r\n\t\tif (typeof childrenSelector === 'string') { this.options.childrenSelector = childrenSelector; }\r\n\r\n\t\t// set children and index\r\n\t\tthis.children = findChildrenInElement(this.element, childrenSelector);\r\n\t\tthis.currentIndex = this.wrapIndex(this.currentIndex);\r\n\r\n\t\t// add classes to new children\r\n\t\tthis.prepareClassNames(this.options.classPrefix, this.options.classAliases);\r\n\t\tfor (const child of this.children) {\r\n\t\t\taddClassToElement(child, this.classAliases.child);\r\n\t\t}\r\n\r\n\t\t// refresh slides\r\n\t\tthis.slide(this.currentIndex);\r\n\r\n\t\t// add classes to the element\r\n\t\taddClassToElement(this.element, this.classAliases.element);\r\n\t\ttoggleClassInElement(this.element, this.classAliases.infinite, this.options.infinite);\r\n\r\n\t\t// trigger event\r\n\t\tthis.emit('init', this.element, this.children);\r\n\t}\r\n\r\n\t/**\r\n\t * Changes the ViewMatrix's current slide.\r\n\t * @param index Slide to change to.\r\n\t */\r\n\tpublic slide(index: number): Element {\r\n\t\tif (!this.children || this.children.length === 0) { return null; }\r\n\r\n\t\t// wrap index for safety\r\n\t\tindex = this.wrapIndex(index);\r\n\r\n\t\t// calc adjacent and distance values\r\n\t\tconst childrenCount = this.children.length;\r\n\t\tconst adjacentCount = Math.max(1, this.options.adjacentCount);\r\n\t\tconst distanceCount = Math.floor((childrenCount - 1) / 2);\r\n\t\tconst indexCount = distanceCount + (childrenCount % 2 === 0 ? 1 : 0);\r\n\r\n\t\t// trigger before event\r\n\t\tthis.emit('slide:before', this.currentIndex, index, childrenCount);\r\n\r\n\t\t// add or remove classes from children\r\n\t\tfor (let i = 0; i < childrenCount; i++) {\r\n\t\t\tconst child = this.children[i];\r\n\t\t\tlet distance = i - index;\r\n\r\n\t\t\tif (this.options.infinite) {\r\n\t\t\t\t// if we're looping around in an infinite gallery,\r\n\t\t\t\t// we loop the distance as well\r\n\t\t\t\tif (distance > distanceCount) {\r\n\t\t\t\t\tdistance -= childrenCount;\r\n\t\t\t\t}\r\n\t\t\t\telse if (distance < -distanceCount) {\r\n\t\t\t\t\tdistance += childrenCount;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (i === index) {\r\n\t\t\t\t// this is the new current element\r\n\t\t\t\t// remove all old classes and add the \"vm-current\" one\r\n\t\t\t\tremoveClassFromElement(child, [\r\n\t\t\t\t\tthis.classAliases.ahead,\r\n\t\t\t\t\tthis.classAliases.behind,\r\n\t\t\t\t\tthis.classAliases.beyond\r\n\t\t\t\t]);\r\n\t\t\t\taddClassToElement(child, this.classAliases.current);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// this is not a current element,\r\n\t\t\t\t// figure out if it's before or after\r\n\t\t\t\tconst isAhead = distance > 0;\r\n\t\t\t\tconst isBehind = distance < 0;\r\n\r\n\t\t\t\t// check if it's beyond the adjacent scope\r\n\t\t\t\tconst isBeyond = Math.abs(distance) > adjacentCount;\r\n\r\n\t\t\t\t// remove \"current\" and toggle other classes\r\n\t\t\t\tremoveClassFromElement(child, this.classAliases.current);\r\n\t\t\t\ttoggleClassInElement(child, this.classAliases.beyond, isBeyond);\r\n\t\t\t\ttoggleClassInElement(child, this.classAliases.behind, isBehind);\r\n\t\t\t\ttoggleClassInElement(child, this.classAliases.ahead, isAhead);\r\n\t\t\t}\r\n\r\n\t\t\t// if we're handling z-index, fix it\r\n\t\t\tif (this.options.handleZIndex) {\r\n\t\t\t\tsetElementStyle(child, 'z-index', indexCount - Math.abs(distance));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// trigger event\r\n\t\tthis.emit('slide', this.currentIndex, index, childrenCount);\r\n\r\n\t\t// set new index\r\n\t\tthis.currentIndex = index;\r\n\r\n\t\t// return child element\r\n\t\treturn this.children[index];\r\n\t}\r\n\r\n\t/**\r\n\t * Increments the ViewMatrix's current slide.\r\n\t * @param inc Value to add to the current index.\r\n\t */\r\n\tpublic inc(increment: number): Element {\r\n\t\treturn this.slide(this.currentIndex + increment);\r\n\t}\r\n\r\n\t/**\r\n\t * Caches all class names for future use.\r\n\t * @param prefix Prefix for all class aliases.\r\n\t * @param aliases String dictionary of class aliases.\r\n\t */\r\n\tprivate prepareClassNames(prefix: string = this.options.classPrefix, aliases: IViewMatrixClassAliases = this.options.classAliases): void {\r\n\t\tfor (const k in aliases) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(aliases, k)) {\r\n\t\t\t\tthis.classAliases[k] = prefix + aliases[k];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Wraps a given \"index\" to be safe for the instance to use.\r\n\t * @param index Index to wrap.\r\n\t */\r\n\tprivate wrapIndex(index: number): number {\r\n\t\tconst max = this.children.length - 1;\r\n\t\treturn this.options.wrap\r\n\t\t\t? wrap(index, 0, max)\r\n\t\t\t: clamp(index, 0, max);\r\n\t}\r\n\r\n}\r\n","/**\r\n * Merges one or more objects into `target`.\r\n * @param target The object to merge to.\r\n * @param sources One or more sources to merge onto `target`.\r\n */\r\nexport function merge<T extends object>(target: T, ...sources: T[]): T {\r\n\tif (target == null) {\r\n\t\tthrow new TypeError('Cannot convert undefined or null to object');\r\n\t}\r\n\tconst to = Object(target);\r\n\tfor (let index = 1; index < arguments.length; index++) {\r\n\t\tconst nextSource = arguments[index];\r\n\t\tif (nextSource != null) {\r\n\t\t\tfor (const nextKey in nextSource) {\r\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\r\n\t\t\t\t\tto[nextKey] = nextSource[nextKey];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn to;\r\n}\r\n","/**\r\n * Clamps a given \"value\" between \"min\" and \"max\", so it never overflows.\r\n * @param value - The value to clamp.\r\n * @param min - Minimum value, inclusive.\r\n * @param max - Maximum value, inclusive.\r\n */\r\nexport function clamp(value: number, min: number, max: number): number {\r\n\treturn Math.max(min, Math.min(max, value));\r\n}\r\n\r\n/**\r\n * Wraps a given \"value\" between \"min\" and \"max\", so it never overflows.\r\n * @param value The value to wrap.\r\n * @param min Minimum value, inclusive.\r\n * @param max Maximum value, inclusive.\r\n */\r\nexport function wrap(value: number = 0, min: number = 0, max: number = 0): number {\r\n\t// make sure we're using the right max\r\n\tmax = Math.max(min, max);\r\n\r\n\t// make math\r\n\tconst x = value - min;\r\n\tconst m = (max + 1) - min;\r\n\treturn min + (x % m + m) % m;\r\n}\r\n","import ViewMatrix from './core/viewmatrix';\r\n\r\n(window as any).ViewMatrix = ViewMatrix;\r\n"],"sourceRoot":""}